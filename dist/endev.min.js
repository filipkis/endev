/*! endev 0.1.0 2014-05-24 */
!function(a){function b(){this.app=angular.module("Endev",[]),this.app.directive("data",["$rootScope","$http","$injector","$interval",function(a,b,c,d){return{restrict:"E",scope:!0,link:function(a,b,e){for(var f=c.get(e.provider?e.provider:0==e.from.search(/http(s)?:\/\//)?"$endev-rest":"$yql"),g=e.from.split(" ")[1],h=new RegExp(/ AND | OR  /i),i=new RegExp(/[=!><]+| (?:NOT )?LIKE | (?:NOT )?IN | IS (?:NOT )?NULL | (?:NOT )?MATCHES /),j=e.where.split(h),k=[],l=0;l<j.length;l++){var m={expression:j[l],lhs:j[l].split(i)[0].trim(),rhs:j[l].split(i)[1].trim(),operator:i.exec(j[l]),replace:function(a){return this.lhs+this.operator+a}};k.push(m)}var n=function(){a.$eval(e.pending),a.$pending=!0,a.$error=null,a.$success=!1,f.query(a,e.from,e.where,k).success(function(b){a[g]=b.query?b.query.results:b,a.$eval(e.success),a.$pending=!1,a.$success=!0}).error(function(b){a.$eval(e.error),a.$pending=!1,a.$success=!1,a.$error=b.description})};n(),e.refresh&&d(n,e.refresh);for(var l=0;l<k.length;l++)a.$watch(k[l].rhs,function(){n()})}}}]),this.app.service("$yql",["$http",function(a){return{query:function(b,c,d,e){for(var f=d,g=0;g<e.length;g++){var h=b.$eval(e[g].rhs);f=f.replace(e[g].expression,e[g].replace("'"+h+"'"))}var i=c.split(" ")[0],j=c.split(" ")[1],k=new RegExp(j+".","g"),l=f.replace(k,""),m="select * from "+i+" where "+l;return a.get("https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(m)+"&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&format=json")}}}]),this.app.service("$endev-rest",["$http",function(a){return{query:function(b,c,d,e){for(var f="",g=0;g<e.length;g++){var h=b.$eval(e[g].rhs);f+=e[g].lhs+"="+encodeURIComponent(h),g<e.length-1&&(f+="&")}var i=c.split(" ")[0],j=c.split(" ")[1],k=new RegExp(j+".","g"),l=f.replace(k,"");return a.get(i+"?"+l)}}}]),this.app.run(["$rootScope",function(a){a.Date=Date,a.Math=Math}])}endev=a.endev=new b}(window||this),angular.element(document).ready(function(){angular.bootstrap(document,["Endev"])});