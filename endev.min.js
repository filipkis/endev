/*! endev 0.2.4 2016-01-11 */

!function(a,b){"use strict";function c(b){try{var c=a[b],d="__storage_test__";return c.setItem(d,d),c.removeItem(d),!0}catch(e){return!1}}function d(b){function c(){void 0===b.escapeMode&&(b.escapeMode=!0),b.attributePrefix=b.attributePrefix||"_",b.arrayAccessForm=b.arrayAccessForm||"none",b.emptyNodeForm=b.emptyNodeForm||"text",void 0===b.enableToStringFunc&&(b.enableToStringFunc=!0),b.arrayAccessFormPaths=b.arrayAccessFormPaths||[],void 0===b.skipEmptyTextNodesForObj&&(b.skipEmptyTextNodesForObj=!0),void 0===b.stripWhitespaces&&(b.stripWhitespaces=!0),b.datetimeAccessFormPaths=b.datetimeAccessFormPaths||[]}function d(){function a(a){var b=String(a);return 1===b.length&&(b="0"+b),b}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),"function"!=typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}function e(a){var b=a.localName;return null==b&&(b=a.baseName),(null==b||""==b)&&(b=a.nodeName),b}function f(a){return a.prefix}function g(a){return"string"==typeof a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):a}function h(a){return a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function i(a,c,d){switch(b.arrayAccessForm){case"property":a[c+"_asArray"]=a[c]instanceof Array?a[c]:[a[c]]}if(!(a[c]instanceof Array)&&b.arrayAccessFormPaths.length>0){for(var e=0;e<b.arrayAccessFormPaths.length;e++){var f=b.arrayAccessFormPaths[e];if("string"==typeof f){if(f==d)break}else if(f instanceof RegExp){if(f.test(d))break}else if("function"==typeof f&&f(a,c,d))break}e!=b.arrayAccessFormPaths.length&&(a[c]=[a[c]])}}function j(a){var b=a.split(/[-T:+Z]/g),c=new Date(b[0],b[1]-1,b[2]),d=b[5].split(".");if(c.setHours(b[3],b[4],d[0]),d.length>1&&c.setMilliseconds(d[1]),b[6]&&b[7]){var e=60*b[6]+Number(b[7]),f=/\d\d-\d\d:\d\d$/.test(a)?"-":"+";e=0+("-"==f?-1*e:e),c.setMinutes(c.getMinutes()-e-c.getTimezoneOffset())}else-1!==a.indexOf("Z",a.length-1)&&(c=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds())));return c}function k(a,c,d){if(b.datetimeAccessFormPaths.length>0){for(var e=d.split(".#")[0],f=0;f<b.datetimeAccessFormPaths.length;f++){var g=b.datetimeAccessFormPaths[f];if("string"==typeof g){if(g==e)break}else if(g instanceof RegExp){if(g.test(e))break}else if("function"==typeof g&&g(obj,c,e))break}return f!=b.datetimeAccessFormPaths.length?j(a):a}return a}function l(a,c){if(a.nodeType==x.DOCUMENT_NODE){for(var d=new Object,g=a.childNodes,j=0;j<g.length;j++){var m=g.item(j);if(m.nodeType==x.ELEMENT_NODE){var n=e(m);d[n]=l(m,n)}}return d}if(a.nodeType==x.ELEMENT_NODE){var d=new Object;d.__cnt=0;for(var g=a.childNodes,j=0;j<g.length;j++){var m=g.item(j),n=e(m);m.nodeType!=x.COMMENT_NODE&&(d.__cnt++,null==d[n]?(d[n]=l(m,c+"."+n),i(d,n,c+"."+n)):(null!=d[n]&&(d[n]instanceof Array||(d[n]=[d[n]],i(d,n,c+"."+n))),d[n][d[n].length]=l(m,c+"."+n)))}for(var o=0;o<a.attributes.length;o++){var p=a.attributes.item(o);d.__cnt++,d[b.attributePrefix+p.name]=p.value}var q=f(a);return null!=q&&""!=q&&(d.__cnt++,d.__prefix=q),null!=d["#text"]&&(d.__text=d["#text"],d.__text instanceof Array&&(d.__text=d.__text.join("\n")),b.escapeMode&&(d.__text=h(d.__text)),b.stripWhitespaces&&(d.__text=d.__text.trim()),delete d["#text"],"property"==b.arrayAccessForm&&delete d["#text_asArray"],d.__text=k(d.__text,n,c+"."+n)),null!=d["#cdata-section"]&&(d.__cdata=d["#cdata-section"],delete d["#cdata-section"],"property"==b.arrayAccessForm&&delete d["#cdata-section_asArray"]),1==d.__cnt&&null!=d.__text?d=d.__text:0==d.__cnt&&"text"==b.emptyNodeForm?d="":d.__cnt>1&&null!=d.__text&&b.skipEmptyTextNodesForObj&&(b.stripWhitespaces&&""==d.__text||""==d.__text.trim())&&delete d.__text,delete d.__cnt,!b.enableToStringFunc||null==d.__text&&null==d.__cdata||(d.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),d}return a.nodeType==x.TEXT_NODE||a.nodeType==x.CDATA_SECTION_NODE?a.nodeValue:void 0}function m(a,c,d,e){var f="<"+(null!=a&&null!=a.__prefix?a.__prefix+":":"")+c;if(null!=d)for(var h=0;h<d.length;h++){var i=d[h],j=a[i];b.escapeMode&&(j=g(j)),f+=" "+i.substr(b.attributePrefix.length)+"='"+j+"'"}return f+=e?"/>":">"}function n(a,b){return"</"+(null!=a.__prefix?a.__prefix+":":"")+b+">"}function o(a,b){return-1!==a.indexOf(b,a.length-b.length)}function p(a,c){return"property"==b.arrayAccessForm&&o(c.toString(),"_asArray")||0==c.toString().indexOf(b.attributePrefix)||0==c.toString().indexOf("__")||a[c]instanceof Function?!0:!1}function q(a){var b=0;if(a instanceof Object)for(var c in a)p(a,c)||b++;return b}function r(a){var c=[];if(a instanceof Object)for(var d in a)-1==d.toString().indexOf("__")&&0==d.toString().indexOf(b.attributePrefix)&&c.push(d);return c}function s(a){var c="";return null!=a.__cdata&&(c+="<![CDATA["+a.__cdata+"]]>"),null!=a.__text&&(c+=b.escapeMode?g(a.__text):a.__text),c}function t(a){var c="";return a instanceof Object?c+=s(a):null!=a&&(c+=b.escapeMode?g(a):a),c}function u(a,b,c){var d="";if(0==a.length)d+=m(a,b,c,!0);else for(var e=0;e<a.length;e++)d+=m(a[e],b,r(a[e]),!1),d+=v(a[e]),d+=n(a[e],b);return d}function v(a){var b="",c=q(a);if(c>0)for(var d in a)if(!p(a,d)){var e=a[d],f=r(e);if(null==e||void 0==e)b+=m(e,d,f,!0);else if(e instanceof Object)if(e instanceof Array)b+=u(e,d,f);else if(e instanceof Date)b+=m(e,d,f,!1),b+=e.toISOString(),b+=n(e,d);else{var g=q(e);g>0||null!=e.__text||null!=e.__cdata?(b+=m(e,d,f,!1),b+=v(e),b+=n(e,d)):b+=m(e,d,f,!0)}else b+=m(e,d,f,!1),b+=t(e),b+=n(e,d)}return b+=t(a)}var w="1.1.5";b=b||{},c(),d();var x={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(b){var c=a.ActiveXObject||"ActiveXObject"in a;if(void 0===b)return null;var d;if(a.DOMParser){var e=new a.DOMParser,f=null;if(!c)try{f=e.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(g){f=null}try{d=e.parseFromString(b,"text/xml"),null!=f&&d.getElementsByTagNameNS(f,"parsererror").length>0&&(d=null)}catch(g){d=null}}else 0==b.indexOf("<?")&&(b=b.substr(b.indexOf("?>")+2)),d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(b);return d},this.asArray=function(a){return a instanceof Array?a:[a]},this.toXmlDateTime=function(a){return a instanceof Date?a.toISOString():"number"==typeof a?new Date(a).toISOString():null},this.asDateTime=function(a){return"string"==typeof a?j(a):a},this.xml2json=function(a){return l(a)},this.xml_str2json=function(a){var b=this.parseXmlString(a);return null!=b?this.xml2json(b):null},this.json2xml_str=function(a){return v(a)},this.json2xml=function(a){var b=this.json2xml_str(a);return this.parseXmlString(b)},this.getVersion=function(){return w}}function e(){this.app=angular.module("Endev")}angular.module("endev-templates",["endevHelper.tpl.html"]),angular.module("endevHelper.tpl.html",[]).run(["$templateCache",function(a){a.put("endevHelper.tpl.html",'<style>\n  #__endev_helper__ {  \n    position: fixed;  \n    bottom: 0;  \n    left: 0;  \n    right: 0;  \n    background: #E0E0E0;  \n    border-top: 1px solid #929292;  \n    padding: 5px;  \n    font-family: sans-serif;  \n    font-size: 12px;  \n  }  \n\n  .__endev_annotation_on__ .__endev_annotated__ { \n    outline: 1px solid rgba(255,0,0,0.5); \n    /*border: 1px solid rgba(255,0,0,0.5); */\n    padding-top: 15px; \n    margin-top:5px;\n    display:block; \n  } \n\n  .__endev_annotation_on__ tbody.__endev_annotated__ {\n    display: table-row-group;\n  }\n  .__endev_annotation__ { \n    display: none; \n  }\n  .__endev_annotation_on__ .__endev_annotated__ > .__endev_annotation__ { \n    display: block; \n    position: absolute; \n    margin-top: -22px; \n    font-size: 10px; \n    font-family: monospace; \n    background: #FFFFD1; \n    color: #666; \n    padding: 1px 3px; \n    border: 1px dashed rgba(255,0,0,0.5); \n    margin-left: 5px; \n    cursor: pointer; \n  } \n  .__endev_annotated__ > .__endev_annotation__:hover { \n    background: rgba(255,255,125,0.9); \n  } \n  .__endev_annotated__ > .__endev_list_item_annotated__ { \n    outline: 1px dashed rgba(255,0,0,0.5); \n  } \n  table.__endev_annotated__, thead.__endev_annotated__, tbody.__endev_annotated__, tfoot.__endev_annotated__  { \n    /*border: 1px solid red;*/\n    padding-top: 10px; \n    margin-top: 10px; \n  } \n  table .__endev_annotated__ > .__endev_annotation__ { \n    margin-top: -1px; \n  }\n</style>\n<div id="__endev_helper__" ng-if="$endevShowHelper">\n  Endev Tools:\n  <button ng-click="$endevAnnotation = !$endevAnnotation">Annotations {{$endevAnnotation ? \'off\' : \'on\'}}</button>\n  <span style="color:red">{{$endevErrors[$endevErrors.length-1].description}}</span>\n</div>')}]),angular.module("endev-data-tag",[]).directive("data",["$rootScope","$http","$injector","$interval","$timeout","$log","$interpolate","Expr",function(a,c,d,e,f,h,i,j){function k(){}function l(){}return{priority:1001,restrict:"E",scope:!0,link:function(a,c,m){var n=m.delay?a.$eval(m.delay):0;a.$eval(m.pending),a.$pending=!0,a.$error=null,a.$success=!1;var o=0,p=function(){if(a.$parent.$pending)f(p,100);else{var c=i(m.from,!1,null,!0)(a),e=c.split(" ")[0],q=d.get(m.provider?"$endev"+m.provider[0].toUpperCase()+m.provider.slice(1):0==c.search(/http(s)?:\/\//)?"$endevRest":"$endevYql"),r=m.from.split(" ")[1],s=m.where?m.where.split(g).map(function(b){var c=new j(b);return c.value=a.$eval(c.rhs),c.attribute=c.lhs.replace(new RegExp("^"+r+".","g"),""),c}):[];if(a.$eval(m.pending),a.$pending=!0,a.$error=null,a.$success=!1,m.log){var t=new k;t.query=new l,t.query.from=c,t.query.where=m.where}var u=b.defaults({from:e,where:m.where,params:s},b.extendOwn({},b.pick(m,function(a,b){return 0!=b.indexOf("$")})));q.query(u).then(function(b){a[r]=b,a.$eval(m.success),a.$pending=!1,a.$success=!0,m.log&&(t.results=a[r],h.info(t))})["catch"](function(b){a.$eval(m.error),a.$pending=!1,a.$success=!1,a.$error=b.description,m.retry&&(a.$pending=!0,f(p,n)),m.log&&(t.data=b,h.error(t))}),0==o&&(s.forEach(function(b){a.$watch(b.rhs,p)}),m.$observe("from",p)),o++}};f(p,n),m.refresh&&e(p,m.refresh)}}}]);var f,g=new RegExp(/ AND | OR  /i),h=new RegExp(/[=!><]+| (?:NOT )?LIKE | (?:NOT )?IN | IS (?:NOT )?NULL | (?:NOT )?MATCHES /);try{angular.module("firebase"),f=angular.module("Endev",["endev-templates","endev-data-tag","firebase"])}catch(i){f=angular.module("Endev",["endev-templates","endev-data-tag"])}var j=angular.injector(["ng","Endev"]);f.factory("Expr",[function(){function a(a,c){this.expression=a,this.lhs=a.split(h)[0].trim(),this.rhs=a.split(h)[1].trim(),this.operator=h.exec(a),this.attribute=this.lhs==c?"":this.lhs.replace(new RegExp("^"+c+".","g"),""),this.setValue=function(a){return this.value=a,this.obj=""!=this.attribute?b.reduceRight(this.attribute.split("."),function(a,b){var c={};return c[b]=a,c},a):a,a},this.replace=function(a){return(this.attribute||this.lhs)+this.operator+a}}return a}]),f.directive("import",["$rootScope",function(b){return{compile:function(c,d){angular.forEach(d["import"].split(","),function(c){c=c.trim(),b[c]=a[c]})}}}]),b.each([["if","ng-show"],["click","ng-click"]],function(a){f.directive(a[0],["$compile",function(b){return{terminal:!0,priority:1e3,compile:function(c,d){return c.attr(a[1],d[a[0]]),c.removeAttr("data-"+a[0]),{pre:function(){},post:function(a,c){b(c)(a)}}}}}])},this),f.directive("new",["$compile",function(a){return{terminal:!0,priority:1e3,compile:function(b){return b.attr("ng-if","$isDefault"),b.removeAttr("data-new"),{pre:function(){},post:function(b,c){a(c)(b)}}}}}]),f.directive("edit",["$compile",function(a){return{terminal:!0,priority:1e3,compile:function(b){return b.attr("ng-if","!$isDefault"),b.removeAttr("data-edit"),{pre:function(){},post:function(b,c){a(c)(b)}}}}}]),f.directive("value",["$compile",function(a){return{priority:1e3,terminal:!0,compile:function(b,c){return"data-value"===c.$attr.value&&(b.attr("ng-model",c.value),b.removeAttr("data-value")),{pre:function(){},post:function(b,c,d){"data-value"===d.$attr.value&&a(c)(b)}}}}}]),f.directive("else",["$compile",function(a){return{terminal:!0,priority:1e3,compile:function(c,d){var e=b.find(c.parent().children(),function(a){return angular.element(a).next()[0]==c[0]});return e&&angular.element(e).attr("ng-show")?d.$set("ng-show","!"+angular.element(e).attr("ng-show")):console.log("data-else needs to come directly after data-if tag"),c.removeAttr("data-else"),{pre:function(){},post:function(b,c){a(c)(b)}}}}}]),f.directive("endevAnnotation",[function(){return{link:function(a,b,c){b.prepend("<span class='__endev_annotation__'>"+c.endevAnnotation+"</span>"),a.$on("$endevData_"+c.endevAnnotation,function(a,c){b.append(angular.toJson(c,!0)),a.stopPropagation()})}}}]),f.directive("endevItem",["$endevProvider","$interpolate",function(a,b){return{link:function(c,d,e){var f=e.endevItem,g=e.endevItem.split(" ")[1],h=b(f,!1,null,!0)(c),i=h.split(" ")[0],j=a.getContext(e.provider,f,d,c),k=j.provider,l=j.parent;if(e.hasOwnProperty("autoUpdate")&&(""==e.autoUpdate||e.autoUpdate)){var m=c[g];if(m&&k.bind&&!m["default"]){console.log("Item value changed",m);var n={from:i,scope:c,label:g};n.object=m,n.data=c["$endevData_"+g],l&&(n.parentLabel=l,n.parentObject=c[l],n.parentData=c["$endevData_"+l]),k.bind(n)}}c.$watch(g,function(a){a&&e.loaded&&c.$eval(e.loaded)})}}}]),f.directive("from",["$interpolate","$endevProvider","$compile","$q","$rootScope","Expr",function(a,c,d,e,f,h){function i(a){return"OPTION"===a[0].tagName?a.parent():a}function j(a,c){var d=b.chain(a).allKeys().filter(function(a){return 0==a.indexOf("$endevData_")}).find(function(d){return b.find(a[d],function(a){return b.isEqual(c,a)})}).value();return d.substring(d.indexOf("_")+1)}return{priority:1e3,restrict:"A",scope:!0,compile:function(e,f){if("DATA"!==e[0].tagName){var l=f.from,m=f.from.split(" ")[1],n="FROM "+f.from;f.where&&(n+=" WHERE "+f.where),f.$set("ng-repeat",m+" in $endevData_"+m+" track by $endevId("+m+",$id)"),f.$set("endev-item",f.from),e.parent().length>0&&["TBODY"].indexOf(e.parent()[0].tagName)>=0?(e.parent().addClass("__endev_annotated__"),e.parent().append("<span class='__endev_annotation__'>"+n+"</span>")):i(e).wrap("<span class='__endev_annotated__'></span>").parent().prepend("<span class='__endev_annotation__'>"+n+"</span>")}return e.removeAttr("data-from"),e.removeAttr("from"),{pre:function(){},post:function(e,f,i){if(f=d(f)(e),"DATA"!==f[0].tagName){if(angular.isDefined(e["$endevData_"+m]))throw new Error("Conflicting object "+m+" defined by:",f);var n=a(l,!1,null,!0)(e),o=n.split(",")[0].split(" ")[0],p=i.where?i.where.split(g).map(function(a){var b=new h(a,m);return b.setValue(e.$eval(b.rhs)),b}):[],q=c.getContext(i.provider,l,f,e),r=q.provider,s=q.parent;e.$endevId=function(a,b){return a?a.$$endevId||a.$id||b(a):b(a)},r.update&&(e.update=function(a,c){var d=j(e,a),f=e["$endevParentType_"+d],g=d,h=e["$endevParentParent_"+d],i={from:f,scope:e,label:g};h&&(i.parentLabel=h,i.parentObject=e[h],i.parentData=e["$endevData_"+h]),i.updatedObject=b.extend(a,c),r.update(i)}),r.remove&&(e.remove=e["delete"]=function(a){var b=j(e,a);k(e["$endevParentType_"+b],a,e["$endevParentParent_"+b],e,e["$endevProvider_"+b])}),e["$endevParentParent_"+m]=s,e["$endevParentType_"+m]=o,e["$endevProvider_"+m]=r;var t=b.map(p,function(a){return a.rhs});s&&t.push(s),t.length>0?e.$watchGroup(t,function(a){b.map(a.length>p.length?a.slice(0,-1):a,function(a,b){p[b].setValue(a)}),console.log("Params changed for ",l,a),w()}):i.$observe("from",function(a){n=a,console.log("From changed for",a),w()});var u,v=function(a){if(angular.isArray(a)||(a=[a]),u&&u(),a&&a.length>0||!i["default"])e.$isDefault=!1;else{var b=e.$eval(i["default"]);angular.isFunction(a.$add)&&i.autoInsert?a.$add(b):a.push(b),e.$isDefault=!0}e["$endevData_"+m]=a,e.$endevAnnotation&&e.$emit("$endevData_"+m,a)},w=b.throttle(function(){if(console.log("Executed with params: ",p),r){var a=b.filter(p,function(a){return"="==a.operator[0]}),c=b.reduce(a,function(a,c){return b.merge(c.obj,a)},{}),d=b.defaults({from:o,where:i.where,params:p,filter:c},b.extendOwn({},b.pick(i,function(a,b){return 0!=b.indexOf("$")})));s&&(d.parentLabel=s,d.parentObject=e[s],d.parentData=e["$endevData_"+s]),r.query(d,null,v).then(function(a){v(a)})["catch"](function(a){console.log("Query error: ",a),e.$endevErrors.push(a)})}},100)}}}},controller:function(a){a.count=function(a){return b.size(a)}}}}]),f.directive("insertInto",["$interpolate","$endevProvider",function(a,c){return{scope:!0,link:function(d,e,f){var g=a(f.insertInto,!1,null,!0)(d),h=c.getContext(f.provider,g,e,d),i=h.provider,j=h.parent;d.insert=function(a){console.log("Inserting:",a);var c={insertInto:g,newObject:a};j&&(c.parentLabel=j,c.parentObject=d[j],c.parentData=d["$endevData_"+j]),i.insert(c).then(function(c){b.isEqual(a,c)||(a=c)})}}}}]);var k=function(a,b,c,d,e){console.log("Removing:",b);var f={removeFrom:a,newObject:b};c&&(f.parentLabel=c,f.parentObject=d[c],f.parentData=d["$endevData_"+c]),e.remove(f)};f.directive("removeFrom",["$interpolate","$endevProvider",function(a,b){return{scope:!0,link:function(c,d,e){var f=a(e.removeFrom,!1,null,!0)(c),g=b.getContext(e.provider,f,d,c),h=g.provider,i=g.parent;c.remove=function(a){k(f,a,i,c,h)}}}}]),f.directive("deleteFrom",["$interpolate","$endevProvider",function(a,b){return{scope:!0,link:function(c,d,e){var f=a(e.deleteFrom,!1,null,!0)(c),g=b.getContext(e.provider,f,d,c),h=g.provider,i=g.parent;c.remove=function(a){k(f,a,i,c,h)}}}}]),f.run(["$rootScope","$document","$templateCache",function(b,c,d){b.Date=Date,b.Math=Math,b.$now=function(){return new Date},b.$endevAnnotation=!1,b.$endevErrors=[],a.endev&&a.endev.logic&&angular.extend(b,a.endev.logic),angular.element(c[0].body).attr("ng-class","{'__endev_annotation_on__':$endevAnnotation}"),angular.element(c[0].body).append(d.get("endevHelper.tpl.html")),(!a.endev||a.endev.showHelper)&&(b.$endevShowHelper=!0)}]),f.directive("list",["$compile",function(a){return{terminal:!0,priority:1e3,compile:function(b,c){return b.parent().prepend("<span class='__endev_annotation__' ng-if='$annotation'>"+c.list+"</span>"),c.$set("ng-class","{'__endev_list_item_annotated__':$annotation}"),c.$set("ng-repeat",c.list),b.removeAttr("data-list"),{pre:function(){},post:function(b,c){var d=a(c)(b);b.$watch("$annotation",function(a){a?(d.parent().addClass("__endev_annotated__"),angular.element(d.parent().children()[0]).removeClass("ng-hide")):(d.parent().removeClass("__endev_annotated__"),angular.element(d.parent().children()[0]).addClass("ng-hide"))})}}}}}]),f.directive("object",["$q",function(a){return{scope:!0,compile:function(b,c){return b.prepend("<span class='__endev_annotation__' ng-if='$annotation'>"+c.object+"</span>"),{pre:function(){},post:function(b,c,d){d.$addClass("ng-hide");var e=d.object.split("=")[0].trim(),f=d.object.split("=")[1].trim();b.$watch(e,function(a){a?d.$removeClass("ng-hide"):d.$addClass("ng-hide")}),b.$watch("$annotation",function(a){a?d.$addClass("__endev_annotated__"):d.$removeClass("__endev_annotated__")}),c.on("click",function(){console.log("Clicked object")});var g;b.$watch(f,function(c){a.when(c).then(function(a){a&&a.$bindTo?(g&&g(),a.$bindTo(b,e).then(function(a){g=a})):b[e]=a})})}}}}}]),j.has("$firebaseObject")&&f.run(["$rootScope","$firebaseArray","$firebaseObject","$q",function(a){a.from=b.memoize(function(){new Firebase("https://endev.firebaseio.com")})}]);var l=new RegExp(/^[a-zA-Z_$][0-9a-zA-Z_$]*/),m=new RegExp(/^([a-zA-Z_$][0-9a-zA-Z_$]*):/),n=function(a,c){var d=[],e=c.filter,f=b.filter(c.params,function(a){return" IN "==a.operator[0]}),g=b.filter(c.params,function(a){return"!="==a.operator[0]}),h=b.filter(c.params,function(a){return">"==a.operator[0]||"<"==a.operator[0]||">="==a.operator[0]||"<="==a.operator[0]});return b.each(a,function(a){var c=!1;a&&e&&(a.$id&&a.$id==e.$id||a.$$endevId&&a.$$endevPath&&a.$$endevId==e.$$endevId&&a.$$endevPath==e.$$endevPath)&&(c=!0),(c||b.isMatchDeep(a,e))&&d.push(a)}),b.each(g,function(a){d=b.filter(d,function(c){return b.valueOnPath(c,a.lhs,!0)!=a.value})}),b.each(h,function(a){d=b.filter(d,function(c){var d=b.valueOnPath(c,a.lhs,!0);switch(a.operator[0]){case">":return d>a.value;case"<":return d<a.value;case">=":return d>=a.value;case"<=":return d<=a.value}})}),b.each(f,function(a){d=b.filter(d,function(c){return b.contains(a.value,b.valueOnPath(c,a.lhs,!0))})}),d},o=function(){var a=[];this.find=function(c){var d=b.find(a,function(a){return a.callback==c});return d||(d={callback:c},a.push(d)),d},this.unwatch=function(a){var b=this.find(a);b.unwatch&&b.unwatch()}};f.service("$endevProvider",["$injector",function(a){return{getContext:function(b,c,d,e){var f,g,b=b||(0==c.search(/http(s)?:\/\//)?"rest":(c.match(m)||[null,null])[1]);if(b)f=a.get("$endev"+b[0].toUpperCase()+b.slice(1));else{var h=c.match(l);h&&(f=e["$endevProvider_"+h[0]],f?g=h[0]:f=a.get("$endevLocal"))}return{provider:f,parent:g}}}}]),f.service("$endevLocal",["$q","$window","$timeout",function(a,d,e){var f={},g=b.memoize(function(a){var d;return d=c("localStorage")&&localStorage.getItem(a)?JSON.parse(localStorage.getItem(a)):{},b.isUndefined(d.$endevUniqId)&&(d.$endevUniqId=0),d}),h=function(a,b){return f[a]||(f[a]=[]),f[a].push(b),function(){f[a].splice(f[a].indexOf(b),1)}};angular.element(d).on("storage",function(a){e(function(){g.cache={},b.each(f[a.key],function(a){b.isFunction(a)&&a()})})});var i=function(a){if(a.indexOf(".")>0){var c=g(a.substring(0,a.indexOf(".")));return b.valueOnPath(c,a,!0)}return g(a)},j=function(a){var c=g(l(a));if(a.indexOf(".")<0)return c;var d=a.substring(a.lastIndexOf(".")+1),e=b.valueOnPath(c,a.substring(0,a.lastIndexOf(".")),!0);return b.isUndefined(e[d])&&(e[d]={}),e[d]},k=function(a,b){return a=a.slice(a.indexOf(":")+1),b?b.$$endevPath+"."+b.$$endevId+"."+a.slice(a.indexOf(".")+1):a},l=function(a){return a.indexOf(".")>0?a.substring(0,a.indexOf(".")):a},m=function(a,c){var d=i(a),e=angular.copy(c);b.each(b.keys(e),function(a){0==a.indexOf("$")&&delete e[a]}),b.merge(d[c.$$endevId],e),r(a)},p=function(a,b){var c=j(a),d=g(l(a));return c[++d.$endevUniqId]=angular.copy(b),r(a),s(b)},q=function(a,b){var c=i(a);delete c[b.$$endevId],r(a)},r=function(a){if(b.each(f[a],function(a){b.isFunction(a)&&a()}),c("localStorage")){var d=l(a);localStorage.setItem(d,JSON.stringify(g(d),function(a,b){return"$watch"==a?void 0:b}))}},s=function(a,c,d){var e;return b.isObject(a)||b.isArray(a)?e=angular.copy(a):(e={},e.$value=a),e.$$endevId=c,e.$$endevPath=d,e},t=function(a){var c=i(a),d=[];return b.each(c,function(b,c){0!==c.indexOf("$")&&d.push(s(b,c,a))}),d},u=new o;return{query:function(b,c,d){var e=a.defer(),f=k(b.from,b.parentObject);u.unwatch(d);var g=t(f),i=n(g,b);return d&&angular.isFunction(d)?d(i,g):e.resolve(i),u.find(d).unwatch=h(f,function(){var a=t(f),c=n(a,b);d&&angular.isFunction(d)&&d(c)}),e.promise},update:function(a){m(k(a.from,a.parentObject),a.updatedObject)},insert:function(b){var c=a.defer();return c.resolve(p(k(b.insertInto,b.parentObject),b.newObject)),c.promise},remove:function(a){q(k(a.removeFrom,a.parentObject),a.newObject)},bind:function(a){a.scope.$watch(a.label,function(b,c){b!=c&&m(k(a.from,a.parentObject),b)},!0)}}}]),f.service("$endevYql",["$http","$q",function(a,c){return{query:function(d,e,f){var g=d.from.slice(d.from.indexOf(":")+1),h=c.defer();if(d.parentLabel){var i=b.valueOnPath(d.parentObject,g,!0);f&&angular.isFunction(f)?f(i):h.resolve(i)}else{for(var j=d.where,k=0;k<d.params.length;k++)j=j.replace(d.params[k].expression,d.params[k].replace("'"+d.params[k].value+"'"));var l;l=d.use?"use '"+d.use+"' as tmpTable; select * from tmpTable":"select * from "+g,j&&(l+=" where "+j),a.get("https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(l)+"&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&format=json").success(function(a){var c=a.query.results;d.use&&g.indexOf(".")>=0&&(c=b.valueOnPath(a.query.results,g,!0)),console.log("Data:",c),h.resolve(c)}).error(function(a){h.reject(a.error)})}return h.promise}}}]),f.service("$endevRest",["$http","$interpolate","$q",function(a,b,c){function e(a,b){return b=angular.isArray(b)?b:[b],b.concat(a)}return{query:function(b){for(var f="",g=0;g<b.params.length;g++)f+=b.params[g].attribute+"="+encodeURIComponent(b.params[g].value),g<b.params.length-1&&(f+="&");var h={headers:angular.isString(b.headers)?angular.fromJson(b.headers):angular.isObject(b.headers)?b.headers:void 0,transformResponse:e(a.defaults.transformResponse,function(a,b){if("application/atom+xml"==b()["content-type"]){var c=new d;return c.xml_str2json(a)}return a})},i=b.from;i=-1!=i.indexOf("?")?i+"&"+f:i+"?"+f;var j=c.defer();return a.get(i,h).success(function(a){j.resolve(a)}).error(function(a){j.reject(a)}),j.promise}}}]),j.has("$firebaseObject")&&f.service("$endevFirebase",["$q","$firebaseObject","$firebaseArray",function(a,c,d){function e(a,b,c,d){if(d){var e=c.$id,f=b?e+"/"+a.substring(b.length+1):e;return console.log("Path with parent:",f),h(d.$ref,f)}return h(g,a)}function f(a,b){var c=n(a,b);return c.$endevProviderType="firebase",c.$ref=a.$ref(),c}var g=new Firebase(endev&&endev.firebaseProvider&&endev.firebaseProvider.path?endev.firebaseProvider.path:"https://endev.firebaseio.com"),h=function(a,b){return b?a.child(b.replace(".","/")):null},i=new o;return{query:function(c,g,h){var j=a.defer(),k=c.from.slice(c.from.indexOf(":")+1);i.unwatch(h);var l=e(k,c.parentLabel,c.parentObject,c.parentData);return d(l).$loaded().then(function(a){console.log("Data:",a);var d=f(a,c);d.$endevRef=l,d.$add=function(b){a.$add(b)},console.log("Object:",d),h&&angular.isFunction(h)?h(d,a):j.resolve(d);var e=function(){console.log("Data changed:",a,c.where),d=f(a,c),h&&angular.isFunction(h)&&h(d),b.each(d,function(a){a.$$endevCallback=e})};b.each(d,function(a){a.$$endevCallback=e}),i.find(h).unwatch=a.$watch(e)}),j.promise},update:function(a){var d=a.from.slice(a.from.indexOf(":")+1),f=e(d,a.parentLabel,a.parentObject,a.parentData);f&&c(f).$loaded().then(function(d){var e=c(d.$ref().child(a.updatedObject.$id));b.merge(e,a.updatedObject),e.$save(),e.$$endevCallback&&angular.isFunction(e.$$endevCallback)&&e.$$endevCallback(e)})},insert:function(b){var c=a.defer(),f=b.insertInto.slice(b.insertInto.indexOf(":")+1),g=e(f,b.parentLabel,b.parentObject,b.parentData);return d(g).$loaded().then(function(a){a.$add(b.newObject).then(function(a){d(a).$loaded().then(function(a){c.resolve(a)})})}),c.promise},remove:function(a){console.log("Removing:",a.newObject);var b=a.removeFrom.slice(a.removeFrom.indexOf(":")+1),d=e(b,a.parentLabel,a.parentObject,a.parentData);c(d).$loaded().then(function(b){c(b.$ref().child(a.newObject.$id)).$remove()})},bind:function(a){var b=a.from.slice(a.from.indexOf(":")+1),d=e(b,null,a.object,a.data);d&&c(d).$bindTo(a.scope,a.label)}}}]),b.merge=function(a){var c=/#{\s*?_\s*?}/,d=Array.prototype.slice;return b.each(d.call(arguments,1),function(d){for(var e in d)if(b.isNull(a[e])||b.isUndefined(a[e])||b.isFunction(a[e])||b.isNull(d[e])||b.isDate(d[e]))a[e]=d[e];else if(b.isString(d[e])&&c.test(d[e]))b.isString(a[e])&&(a[e]=d[e].replace(c,a[e]));else if(b.isArray(a[e])||b.isArray(d[e])){if(!b.isArray(a[e])||!b.isArray(d[e]))throw new Error("Trying to combine an array with a non-array ("+e+")");a[e]=b.reject(b.merge(b.clone(a[e]),d[e]),function(a){return b.isNull(a)})}else if(b.isObject(a[e])||b.isObject(d[e])){if(!b.isObject(a[e])||!b.isObject(d[e]))throw new Error("Trying to combine an object with a non-object ("+e+")");a[e]=b.merge(b.clone(a[e]),d[e])}else a[e]=d[e]}),a},b.isMatchDeep=function(a,c){c=b.extendOwn({},c);var d=b.keys(c),e=d.length;if(null==a)return!e;for(var f=Object(a),g=0;e>g;g++){var h=d[g];if(b.isObject(c[h])){if(!b.isMatchDeep(a[h],c[h]))return!1}else if(c[h]!==f[h]||!(h in f))return!1}return!0},b.matcherDeep=function(a){return function(c){return b.isMatchDeep(c,a)}};b.valueOnPath=function(a,c,d){return d&&c.indexOf(".")<0?a:b.reduce((d?c.substring(c.indexOf(".")+1):c).split("."),function(a,b){return angular.isDefined(a)?a[b]:null},a)},endev=a.endev=new e}(window||this,_),angular.element(document).ready(function(){endev.autoStart!==!1&&angular.bootstrap(document,["Endev"])});
//# sourceMappingURL=endev.min.map