/*! endev 0.1.0 2014-05-24 */
!function(a){function b(){this.app=angular.module("Endev",[]),this.app.directive("data",["$rootScope","$http","$injector",function(a,b,c){return{restrict:"E",scope:!0,link:function(a,b,d){for(var e=c.get(d.provider?d.provider:0==d.from.search(/http(s)?:\/\//)?"$endev-rest":"$yql"),f=d.from.split(" ")[1],g=new RegExp(/ AND | OR  /i),h=new RegExp(/[=!><]+| (?:NOT )?LIKE | (?:NOT )?IN | IS (?:NOT )?NULL | (?:NOT )?MATCHES /),i=d.where.split(g),j=[],k=0;k<i.length;k++){var l={expression:i[k],lhs:i[k].split(h)[0].trim(),rhs:i[k].split(h)[1].trim(),operator:h.exec(i[k]),replace:function(a){return this.lhs+this.operator+a}};j.push(l)}var m=function(){a.$eval(d.pending),a.$pending=!0,a.$error=null,a.$success=!1,e.query(a,d.from,d.where,j).success(function(b){a[f]=b.query.results,a.$eval(d.success),a.$pending=!1,a.$success=!0}).error(function(b){a.$eval(d.error),a.$pending=!1,a.$success=!1,a.$error=b.description})};m();for(var k=0;k<j.length;k++)a.$watch(j[k].rhs,function(){m()})}}}]),this.app.service("$yql",["$http",function(a){return{query:function(b,c,d,e){for(var f=d,g=0;g<e.length;g++){var h=b.$eval(e[g].rhs);f=f.replace(e[g].expression,e[g].replace("'"+h+"'"))}var i=c.split(" ")[0],j=c.split(" ")[1],k=new RegExp(j+".","g"),l=f.replace(k,""),m="select * from "+i+" where "+l;return a.get("https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(m)+"&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&format=json")}}}]),this.app.service("$endev-rest",["$http",function(a){return{query:function(b,c,d,e){for(var f="",g=0;g<e.length;g++){var h=b.$eval(e[g].rhs);f+=e[g].lhs+"='"+h+"'",g<e.length-1&&(f+="&")}var i=c.split(" ")[0],j=c.split(" ")[1],k=new RegExp(j+".","g"),l=f.replace(k,"");return a.get(i+"?"+encodeURIComponent(l))}}}]),this.app.run()}endev=a.endev=new b}(window||this),angular.element(document).ready(function(){angular.bootstrap(document,["Endev"])});