/*! endev 0.2.0 2014-12-03 */
!function(a){function b(){function a(a){this.expression=a,this.lhs=a.split(e)[0].trim(),this.rhs=a.split(e)[1].trim(),this.operator=e.exec(a),this.replace=function(a){return this.lhs+this.operator+a}}var b=new RegExp(/ AND | OR  /i),e=new RegExp(/[=!><]+| (?:NOT )?LIKE | (?:NOT )?IN | IS (?:NOT )?NULL | (?:NOT )?MATCHES /);this.app=angular.module("Endev",[]),this.app.directive("data",["$rootScope","$http","$injector","$interval","$timeout","$log","$interpolate",function(e,f,g,h,i,j,k){return{restrict:"E",scope:!0,link:function(e,f,l){var m=l.delay?e.$eval(l.delay):0;e.$eval(l.pending),e.$pending=!0,e.$error=null,e.$success=!1;var n=0,o=function(){if(e.$parent.$pending)i(o,100);else{var f=k(l.from,!1,null,!0)(e),h=g.get(l.provider?l.provider:0==f.search(/http(s)?:\/\//)?"$endev-rest":"$yql"),p=l.from.split(" ")[1],q=[];if(l.where&&(q=l.where.split(b).map(function(b){return new a(b)})),e.$eval(l.pending),e.$pending=!0,e.$error=null,e.$success=!1,l.log){var r=new c;r.query=new d,r.query.from=f,r.query.where=l.where}if(h.query(e,f,l.where,q,l).success(function(a){e[p]=a.query?a.query.results:a,e.$eval(l.success),e.$pending=!1,e.$success=!0,l.log&&(r.results=e[p],j.info(r))}).error(function(a){e.$eval(l.error),e.$pending=!1,e.$success=!1,e.$error=a.description,l.retry&&(e.$pending=!0,i(o,m)),l.log&&(r.data=a,j.error(r))}),0==n){for(var s=0;s<q.length;s++)e.$watch(q[s].rhs,o);l.$observe("from",function(a){console.log(a),o()})}n++}};i(o,m),l.refresh&&h(o,l.refresh)}}}]),this.app.service("$yql",["$http",function(a){return{query:function(b,c,d,e){for(var f=d,g=0;g<e.length;g++){var h=b.$eval(e[g].rhs);f=f.replace(e[g].expression,e[g].replace("'"+h+"'"))}var i=c.split(" ")[0],j=c.split(" ")[1],k=new RegExp(j+".","g");if(f)var l=f.replace(k,"");else var l="";var m="select * from "+i+" where "+l;return a.get("https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(m)+"&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&format=json")}}}]),this.app.service("$firebase",["$http","$injector",function(a,b){return{query:function(){b.get("$firebase")}}}]),this.app.service("$endev-rest",["$http","$interpolate",function(a){return{query:function(b,c,d,e,f){for(var g="",h=0;h<e.length;h++){var i=b.$eval(e[h].rhs);g+=e[h].lhs+"="+encodeURIComponent(i),h<e.length-1&&(g+="&")}var j=c.split(" ")[0],k=c.split(" ")[1],l=new RegExp(k+".","g"),m=g.replace(l,""),n=b.$eval(f.headers),o={headers:n,transformResponse:function(a,c){if("application/atom+xml"==c()["content-type"]){var d=new X2JS;return d.xml_str2json(a)}return b.$eval(a)}},p=j;return p=-1!=p.indexOf("?")?p+"&"+m:p+"?"+m,a.get(p,o)}}}]),this.app.run(["$rootScope",function(a){a.Date=Date,a.Math=Math}])}function c(){}function d(){}endev=a.endev=new b}(window||this),angular.element(document).ready(function(){angular.bootstrap(document,["Endev"])});